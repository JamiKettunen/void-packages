# Template file for 'pmos-tweaks'
_githash=a6ef3db9cd67f35d0e5940ccd109cda143554d57 # tip of master branch as of 2021-07-18
_gitshort=${_githash:0:7}

pkgname=pmos-tweaks
version=0.7.0
revision=1
build_style=meson
makedepends="libhandy1-devel"
hostmakedepends="pkg-config"
depends="python3-yaml"
short_desc="Application for exposing extra settings easily on mobile platforms [git ${_gitshort}]"
maintainer="Jami Kettunen <jami.kettunen@protonmail.com>"
license="GPL-3.0-or-later"
homepage="https://gitlab.com/postmarketOS/postmarketos-tweaks"
distfiles="https://gitlab.com/postmarketOS/postmarketos-tweaks/-/archive/${_githash}/$pkgname-${_githash}.tar.gz>$pkgname-${_gitshort}.tar.gz"
wrksrc="postmarketos-tweaks-${_githash}"
checksum=15bf330d92e4a039acc2da05c8af40c7105bd57d314b5ff75ebe648babb4337c
_ymldir="usr/share/postmarketos-tweaks"

post_install() {
	# unused OpenRC service file(s)
	rm -r "$DESTDIR"/etc/init.d

	# unused pmOS initramfs osk-sdl menu
	rm "$DESTDIR/${_ymldir}"/unlocker.yml

	vlicense LICENSE
}

_vmove_yml() {
	vmove ${_ymldir}/$1.yml
}

pmos-tweaks-phosh_package() {
	short_desc+=" - Phosh entries"
	depends="${sourcepkg}>=${version}_${revision}"
	pkg_install() {
		_vmove_yml phosh
	}
}

pmos-tweaks-pinephone_package() {
	short_desc+=" - PinePhone entries"
	depends="${sourcepkg}>=${version}_${revision}"
	pkg_install() {
		_vmove_yml pinephone
	}
}
